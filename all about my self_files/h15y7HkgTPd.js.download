;/*FB_PKG_DELIM*/

__d("E2EEBackupSecretRegisterModule",["E2EEBackupCommon","Promise","QuickPerformanceLogger","VestaClient","VestaClientError","asyncToGeneratorRuntime","qpl"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("qpl")._(235865454,"167");function a(a,b,d){(i||(i=c("QuickPerformanceLogger"))).markerStart(j);i.markerAnnotate(j,{string:{product_use_case:b.productUseCase,registration_mode:"regular_mode"}});return k(a,b,!1,d)}function e(a,b,d){(i||(i=c("QuickPerformanceLogger"))).markerStart(j);i.markerAnnotate(j,{string:{product_use_case:b.productUseCase,registration_mode:"re-register_mode"}});return k(a,b,!0,d)}function k(a,b,c,d){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e,f,g){try{var k=(yield a.initRegister({clientId:e.clientId,productUseCase:e.productUseCase},g)),l=k.isRegistered,m=k.islandEd25519Pub,n=k.islandEd25519PubSig,o=k.islandRsaPub;k=k.islandRsaPubSig;(i||(i=c("QuickPerformanceLogger"))).markerPoint(j,"init_register_network_call");if(l&&!f){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"ALREADY_REGISTERED"}});i.markerEnd(j,3376);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.ALREADY_REGISTERED)}l=(yield (h||(h=b("Promise"))).all([d("VestaClient").validateHsmKey(o,k),d("VestaClient").validateHsmKey(m,n)]));f=l[0];k=l[1];if(!f){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"ISLAND_PUB_RSA_KEY_INVALID"}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_RSA_KEY_INVALID)}if(!k){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"ISLAND_PUB_ED25519_KEY_INVALID"}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.ISLAND_PUB_ED25519_KEY_INVALID)}i.markerPoint(j,"verify_island_rsa_key");i.markerPoint(j,"verify_island_ed25519_key");n=e.vestaAccountPin;if(n==null)throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.MISSING_PIN_INPUT);else{l=new TextEncoder();f=(yield d("VestaClient").beginRegister(l.encode(n)));k=f.clientState;l=f.r1Message;(i||(i=c("QuickPerformanceLogger"))).markerPoint(j,"begin_register_vesta_client");n=(yield a.beginRegister({clientId:e.clientId,productUseCase:e.productUseCase,opaqueR1:l},g));f=n.opaqueChallenge;var p=n.opaqueR2;n=n.opaqueR2Sig;i.markerPoint(j,"begin_register_network_call");l=(yield d("VestaClient").finishRegister(l,p,n,m,k,e.secret,f,o));p=l.registerPayload;i.markerPoint(j,"finish_register_vesta_client");n=(yield a.finishRegister({clientId:e.clientId,productUseCase:e.productUseCase,encRegPayload:p},g));m=n.registerSuccess;i.markerPoint(j,"finish_register_network_call");if(!m){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"VESTA_SERVER_ERROR"}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.VESTA_SERVER_ERROR)}i.markerEnd(j,2)}}catch(a){if(a instanceof d("E2EEBackupCommon").BackupError)throw a;else if(a instanceof c("VestaClientError")){(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:"VestaClientException: "+a.name}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.VESTA_CLIENT_ERROR,a)}else{(i||(i=c("QuickPerformanceLogger"))).markerAnnotate(j,{string:{failure_reason:a.message}});i.markerEnd(j,3);throw new(d("E2EEBackupCommon").BackupError)(d("E2EEBackupCommon").BackupErrorType.NETWORK_PROVIDER_ERROR,a)}}});return l.apply(this,arguments)}g.registerBackupSecret=a;g.reRegisterBackupSecret=e}),98);
__d("LSHandleCreateVirtualDeviceFailure",["LSAppendDataTraceAddon","LSDeleteBackupOnClient","LSFlushDataTrace.nop","LSIsMobileClient","LSLogMebClientEvent.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure] Beginning execution."),c.sequence([function(d){return a[2]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[2],c.i64.cast([0,1412]),c.i64.cast([0,2]),void 0,void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[7]=a[0],a})},function(a){return d[7]?d[8]=!0:d[8]=!1,d[8]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[9]=c.createArray(),void 0!==void 0?d[10]=(d[9].push(void 0),d[9]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[9],c.i64.cast([0,3]))):c.resolve()}])},function(e){return a[1]?c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure] Failure when creating virtual device, deleting backup"),d[7]=c.createArray(),void 0!==void 0?d[8]=(d[7].push(void 0),d[7]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure","Failure when creating virtual device, deleting backup",d[7],c.i64.cast([0,3]))},function(d){return c.storedProcedure(b("LSDeleteBackupOnClient"),a[0],void 0,!1,a[2],void 0,!1)}]):c.sequence([function(e){return d[7]="Failure when creating virtual device",d[7]!==void 0?c.sequence([function(e){return d[9]=["[EncryptedBackups][LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure] ","",d[7]].join(""),function(a){c.logger(a).mustfix(a)}(d[9]),d[8]=c.createArray(),a[2]!==void 0?d[10]=(d[8].push(a[2]),d[8]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure",d[7],d[8],c.i64.cast([0,3]))},function(e){return c.sequence([function(e){return a[2]!==void 0?c.sequence([function(e){return a[2]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[2],c.i64.cast([0,85]),c.i64.cast([0,2]),d[9],void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[12]=a[0],a})},function(a){return d[12]?d[13]=!0:d[13]=!1,d[13]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[14],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[2]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[2]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[10]=a[0],a})},function(a){return d[10]?d[11]=!0:d[11]=!1,d[11]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[12],c.i64.cast([0,3]))):c.resolve()}])}]):c.sequence([function(e){return a[2]!==void 0?c.sequence([function(d){return a[2]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[2],c.i64.cast([0,85]),c.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure] ","",""].join(""),void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[10]=a[0],a})},function(a){return d[10]?d[11]=!0:d[11]=!1,d[11]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[12]=c.createArray(),void 0!==void 0?d[13]=(d[12].push(void 0),d[12]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[12],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[2]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[2]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[8]=a[0],a})},function(a){return d[8]?d[9]=!0:d[9]=!1,d[9]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[10]=c.createArray(),void 0!==void 0?d[11]=(d[10].push(void 0),d[10]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[10],c.i64.cast([0,3]))):c.resolve()}])},function(a){return c.db.table(178).put({pk:c.i64.cast([0,1]),recoveryCodeStatus:c.i64.cast([0,3])})}])},function(e){return c.sequence([function(e){return a[2]!==void 0?c.sequence([function(d){return a[2]!==void 0?c.storedProcedure(b("LSAppendDataTraceAddon"),a[2],c.i64.cast([0,85]),c.i64.cast([0,2]),"The flow did not succeed",void 0):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[9]=a[0],a})},function(a){return d[9]?d[10]=!0:d[10]=!1,d[10]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[11]=c.createArray(),void 0!==void 0?d[12]=(d[11].push(void 0),d[11]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[11],c.i64.cast([0,3]))):c.resolve()}]):c.resolve()},function(d){return a[2]!==void 0?c.nativeOperation(b("LSFlushDataTrace.nop"),a[2]):c.resolve()},function(a){return c.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,d[7]=a[0],a})},function(a){return d[7]?d[8]=!0:d[8]=!1,d[8]&&!0?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),d[9]=c.createArray(),void 0!==void 0?d[10]=(d[9].push(void 0),d[9]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",d[9],c.i64.cast([0,3]))):c.resolve()}])},function(a){return d[1]=c.i64.of_float(Date.now()),d[2]=c.i64.random(),d[4]="Finishing execution. Execution time: ",d[5]=c.i64.to_string(c.i64.sub(d[1],d[0])),d[6]=" ms",d[3]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure] ",d[3],d[4],d[3],d[5],d[3],d[6]].join("")),c.i64.eq(c.i64.mod_(d[2],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[7]=",",d[8]=c.createArray(),void 0!==void 0?d[9]=(d[8].push(void 0),d[8]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure",[d[4],d[7],d[5],d[7],d[6]].join(""),d[8],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsHandleCreateVirtualDeviceFailureStoredProcedure";a.__tables__=["secure_encrypted_backups_recovery_code_status"];e.exports=a}),null);
__d("LSCreateExtraVirtualDevice",["LSAppendDataTraceAddon","LSArrayGetObjectAt","LSBase64Encode.nop","LSCreateDebugToken.nop","LSCreateDerivedKeys.nop","LSCreateEncryptionKeyPair.nop","LSCreateSignatureKeyPair.nop","LSCreateSignatureWithArmadilloKey.nop","LSCreateSignature_v2.nop","LSFlushDataTrace.nop","LSGetArmadilloPublicKey.nop","LSGetBlobFromString.nop","LSGetOpenEpochKeys","LSGetViewerFBID","LSHandleCreateVirtualDeviceFailure","LSHmac_v2.nop","LSIsEncryptionVersionSecure","LSIsMobileClient","LSIssueNewEbTaskAndGetTaskIDV2","LSLogMebClientEvent.nop","LSOcmfClientEvolve_v2.nop","LSParseRecoveryCode_v2.nop","LSSymmetricEncryptionCreateEncryptedString.nop","justknobx"],(function(a,b,c,d,e,f,g){function a(){var a=arguments,d=a[a.length-1],e=[],f=[];return d.sequence([function(g){return d.sequence([function(c){return e[0]=d.i64.of_float(Date.now()),function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] Beginning execution."),d.i64.eq(a[0],d.i64.cast([0,1]))?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,1429]),d.i64.cast([0,2]),void 0,["50012"].join("")):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[26]=a[0],a})},function(a){return e[26]?e[27]=!0:e[27]=!1,e[27]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[28]=d.createArray(),void 0!==void 0?e[29]=(e[28].push(void 0),e[28]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[28],d.i64.cast([0,3]))):d.resolve()}]):d.i64.eq(a[0],d.i64.cast([0,2]))?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,1429]),d.i64.cast([0,2]),void 0,["50013"].join("")):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[26]=a[0],a})},function(a){return e[26]?e[27]=!0:e[27]=!1,e[27]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[28]=d.createArray(),void 0!==void 0?e[29]=(e[28].push(void 0),e[28]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[28],d.i64.cast([0,3]))):d.resolve()}]):d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,1429]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[26]=a[0],a})},function(a){return e[26]?e[27]=!0:e[27]=!1,e[27]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[28]=d.createArray(),void 0!==void 0?e[29]=(e[28].push(void 0),e[28]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[28],d.i64.cast([0,3]))):d.resolve()}])},function(a){return d.islc(d.filter(d.db.table(168).fetch(),function(a){return d.i64.eq(a.authorityLevel,d.i64.cast([0,80]))}),0,d.i64.to_float(d.i64.cast([0,1]))).next().then(function(a,c){var f=a.done;a=a.value;return f?(f=[void 0,void 0,void 0,void 0,void 0,void 0,void 0,d.i64.cast([0,1]),void 0,void 0,void 0,void 0,void 0,void 0,void 0,d.i64.cast([0,20]),void 0],e[1]=f[0],e[2]=f[1],e[3]=f[2],e[4]=f[3],e[5]=f[4],e[6]=f[5],e[7]=f[6],e[8]=f[7],e[9]=f[8],e[10]=f[9],e[11]=f[10],e[12]=f[11],e[13]=f[12],e[14]=f[13],e[15]=f[14],e[16]=f[15],e[17]=f[16],f):(c=a.item,d.sequence([function(a){return e[31]=c.backupTenancy,e[30]=c.encryptionVersion,e[26]=void 0,d.i64.neq(e[26],void 0)?d.resolve(e[27]=e[26]):d.sequence([function(a){return e[32]=d.createArray(),d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,0])).then(function(a){return a=a,e[33]=a[0],a})},function(a){return e[33]?e[42]=(e[32].push(d.i64.cast([0,0])),e[32]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,2])).then(function(a){return a=a,e[34]=a[0],a})},function(a){return e[34]?e[42]=(e[32].push(d.i64.cast([0,2])),e[32]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,3])).then(function(a){return a=a,e[35]=a[0],a})},function(a){return e[35]?e[42]=(e[32].push(d.i64.cast([0,3])),e[32]):0,d.storedProcedure(b("LSIsEncryptionVersionSecure"),d.i64.cast([0,4])).then(function(a){return a=a,e[36]=a[0],a})},function(a){return e[36]?e[42]=(e[32].push(d.i64.cast([0,4])),e[32]):0,e[37]=d.createArray(),e[38]=d.i64.of_int32(e[32].length),d.i64.gt(e[38],d.i64.cast([0,0]))?d.loopAsync(e[38],function(a){return e[42]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[32],e[42]).then(function(a){return a=a,e[43]=a[0],e[44]=a[1],a})},function(a){return e[45]=(e[37].push(e[43]),e[37])}])}):d.resolve()},function(a){return d.sequence([function(a){return e[42]=d.createArray(),e[43]=d.i64.of_int32(e[37].length),d.i64.gt(e[43],d.i64.cast([0,0]))?d.loopAsync(e[43],function(a){return e[45]=a,d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[37],e[45]).then(function(a){return a=a,e[46]=a[0],e[47]=a[1],a})},function(a){return e[48]=(e[42].push(d.i64.to_string(e[46])),e[42])}])}):d.resolve()},function(a){return e[44]=e[42].join(","),e[39]=e[44]}])},function(a){return e[37].some(function(a){return d.i64.eq(e[30],a)})?e[40]=e[30]:e[40]=void 0,d.i64.neq(e[40],void 0)?e[41]=e[40]:e[41]=void 0,e[27]=e[41]}])},function(a){return d.i64.neq(e[27],void 0)?e[28]=e[27]:e[28]=d.i64.cast([0,0]),d.i64.neq(e[31],void 0)?e[29]=e[31]:e[29]=d.i64.cast([0,1]),a=[c.backupId,c.deviceId,c.mailboxRootKeyBlob,c.ocmfClientStateBlob,void 0,void 0,e[28],e[29],c.epochAuthPublicKeyBlob,c.epochAuthPrivateKeyBlob,c.devicePublicKeyBlob,c.devicePrivateKeyBlob,c.epochStoragePublicKeyBlob,c.epochStoragePrivateKeyBlob,c.obliviousValidationTokenBlob,c.authorityLevel,void 0],e[1]=a[0],e[2]=a[1],e[3]=a[2],e[4]=a[3],e[5]=a[4],e[6]=a[5],e[7]=a[6],e[8]=a[7],e[9]=a[8],e[10]=a[9],e[11]=a[10],e[12]=a[11],e[13]=a[12],e[14]=a[13],e[15]=a[14],e[16]=a[15],e[17]=a[16],a}]))})},function(f){return d.i64.neq(e[1],void 0)?d.sequence([function(f){return d.db.table(174).fetch([[[d.i64.cast([0,1])]]]).next().then(function(f,g){var h=f.done;f=f.value;return h?d.sequence([function(a){return d.db.table(178).put({pk:d.i64.cast([0,1]),recoveryCodeStatus:d.i64.cast([0,3])})},function(a){return e[28]="Recovery code not created, will not create extra virtual device",e[28]!==void 0?d.sequence([function(a){return e[30]=["[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] ","",e[28]].join(""),function(a){d.logger(a).mustfix(a)}(e[30]),e[29]=d.createArray(),void 0!==void 0?e[31]=(e[29].push(void 0),e[29]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure",e[28],e[29],d.i64.cast([0,3]))},function(a){return d.sequence([function(a){return void 0!==void 0?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,85]),d.i64.cast([0,2]),e[30],void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[33]=a[0],a})},function(a){return e[33]?e[34]=!0:e[34]=!1,e[34]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[35]=d.createArray(),void 0!==void 0?e[36]=(e[35].push(void 0),e[35]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[35],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return void 0!==void 0?d.nativeOperation(b("LSFlushDataTrace.nop"),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[31]=a[0],a})},function(a){return e[31]?e[32]=!0:e[32]=!1,e[32]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[33]=d.createArray(),void 0!==void 0?e[34]=(e[33].push(void 0),e[33]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[33],d.i64.cast([0,3]))):d.resolve()}])}]):d.sequence([function(a){return void 0!==void 0?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] ","",""].join(""),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[31]=a[0],a})},function(a){return e[31]?e[32]=!0:e[32]=!1,e[32]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[33]=d.createArray(),void 0!==void 0?e[34]=(e[33].push(void 0),e[33]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[33],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return void 0!==void 0?d.nativeOperation(b("LSFlushDataTrace.nop"),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[29]=a[0],a})},function(a){return e[29]?e[30]=!0:e[30]=!1,e[30]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[31]=d.createArray(),void 0!==void 0?e[32]=(e[31].push(void 0),e[31]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[31],d.i64.cast([0,3]))):d.resolve()}])},function(a){return e[26]=d.i64.cast([0,1])}]):(g=f.item,d.sequence([function(a){return e[30]=g.recoveryCode,e[31]=g.virtualDeviceType,e[32]=g.cloudServiceAccount,e[33]=g.hsmPinNormalizationStatus,d.db.table(178).put({pk:d.i64.cast([0,1]),recoveryCodeStatus:d.i64.cast([0,1])})},function(a){return d.db.table(168).fetch().next().then(function(b,c){var a=b.done;b=b.value;return a?e[28]=d.i64.cast([0,1]):(c=b.item,e[35]=c.backupTenancy,d.i64.neq(e[35],void 0)?e[34]=e[35]:e[34]=d.i64.cast([0,1]),e[28]=e[34])})},function(f){return d.i64.eq(e[28],d.i64.cast([0,1]))&&e[30]==="1SHADOWTESTINGRECOVERYCODE00000000000000"?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Used."),e[34]=d.createArray(),void 0!==void 0?e[35]=(e[34].push(void 0),e[34]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","Invalid Recovery Code Used.",e[34],d.i64.cast([0,3]))):d.sequence([function(a){return e[34]=d.createArray(),d.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,e[35]=a[0],a})},function(a){return d.nativeOperation(b("LSParseRecoveryCode_v2.nop"),e[30],void 0==null?d.i64.to_string(e[35]):void 0,e[34]).then(function(a){return a=a,e[36]=a[0],e[37]=a[1],a})},function(f){return d.blobs.neq(e[37],void 0)?d.blobs.neq(e[36],void 0)?d.sequence([function(a){return d.storedProcedure(b("LSGetOpenEpochKeys"),!1).then(function(a){return a=a,e[38]=a[0],a})},function(f){return e[38]!==void 0?d.sequence([function(a){return e[105]=c("justknobx")._("1310"),void 0!==void 0?e[105]?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,2866]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[115]=a[0],a})},function(a){return e[115]?e[116]=!0:e[116]=!1,e[116]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[117]=d.createArray(),void 0!==void 0?e[118]=(e[117].push(void 0),e[117]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[117],d.i64.cast([0,3]))):d.resolve()}]):d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,2867]),d.i64.cast([0,2]),void 0,void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[115]=a[0],a})},function(a){return e[115]?e[116]=!0:e[116]=!1,e[116]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[117]=d.createArray(),void 0!==void 0?e[118]=(e[117].push(void 0),e[117]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[117],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return e[105]?d.resolve():d.sequence([function(a){return d.count(d.db.table(169).fetch()).then(function(a){return e[115]=a})},function(a){return d.i64.gt(e[115],d.i64.cast([0,1]))?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Multiple rows in $epoch_tables."),e[116]=d.createArray(),void 0!==void 0?e[117]=(e[116].push(void 0),e[116]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","Multiple rows in $epoch_tables.",e[116],d.i64.cast([0,3]))):d.resolve()}])},function(a){return d.nativeOperation(b("LSCreateSignatureKeyPair.nop")).then(function(a){return a=a,e[39]=a[0],e[40]=a[1],a})},function(a){return d.nativeOperation(b("LSCreateEncryptionKeyPair.nop")).then(function(a){return a=a,e[41]=a[0],e[42]=a[1],a})},function(a){return d.nativeOperation(b("LSCreateSignature_v2.nop"),e[39],d.blob("MA=="),e[42]).then(function(a){return a=a,e[43]=a[0],a})},function(a){return e[106]=d.blob(""),e[107]=d.blob(""),e[108]=d.blob(""),d.db.table(168).fetch([[[e[1]]]]).next().then(function(c,f){var a=c.done;c=c.value;return a?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Row with backupid not found in client state table"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","Row with backupid not found in client state table",e[115],d.i64.cast([0,3]))},function(a){return a=[e[106],e[107],void 0,e[108]],e[44]=a[0],e[45]=a[1],e[46]=a[2],e[47]=a[3],a}]):(f=c.item,a=[f.obliviousValidationTokenBlob,f.mailboxRootKeyBlob,f.deviceId,f.ocmfClientStateBlob],e[44]=a[0],e[45]=a[1],e[46]=a[2],e[47]=a[3],a)})},function(a){return d.blobs.eq(e[44],e[106])?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] oblivious_token is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","oblivious_token is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return d.blobs.eq(e[45],e[107])?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] mailbox_root_key is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","mailbox_root_key is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return d.blobs.eq(e[47],e[108])?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] ocmf_client_state is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","ocmf_client_state is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return e[49]=e[38].get("epoch_anon_id"),e[50]=e[38].get("epoch_root_key"),e[51]=d.createArray(),e[115]=(e[51].push(d.i64.cast([0,32])),e[51]),d.nativeOperation(b("LSBase64Encode.nop"),e[49]).then(function(a){return a=a,e[52]=a[0],a})},function(a){return e[52]!==void 0?d.sequence([function(a){return d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blobs.of_string(["epoch_devices","_",e[52]].join("")),void 0,e[50],e[51]).then(function(a){return a=a,e[115]=a[0],a})},function(a){return e[115]?e[116]=!1:e[116]=!0,e[116]?d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish"),e[118]=d.createArray(),void 0!==void 0?e[120]=(e[118].push(void 0),e[118]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","THIS IS NOT EXPECTED. Found null keys while deriving keys for epoch. Returning empty blobish",e[118],d.i64.cast([0,3]))},function(a){return d.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,e[119]=a[0],a})},function(a){return e[117]=e[119]}]):d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[115],d.i64.cast([0,0])).then(function(a){return a=a,e[118]=a[0],e[119]=a[1],a})},function(a){return e[117]=e[118]}])},function(a){return e[53]=e[117]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoEpochUtils] THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish"),e[115]=d.createArray(),void 0!==void 0?e[117]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoEpochUtils","THIS IS NOT EXPECTED. Failed to base64 encode epoch anon id. Returning empty blobish",e[115],d.i64.cast([0,3]))},function(a){return d.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,e[116]=a[0],a})},function(a){return e[53]=e[116]}])},function(a){return d.nativeOperation(b("LSHmac_v2.nop"),e[53],e[40]).then(function(a){return a=a,e[54]=a[0],a})},function(a){return d.blobs.neq(e[54],void 0)?d.resolve(e[55]=e[54]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] device_epoch_hmac is null!"),e[115]=d.createArray(),void 0!==void 0?e[117]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","device_epoch_hmac is null!",e[115],d.i64.cast([0,3]))},function(a){return d.nativeOperation(b("LSGetBlobFromString.nop"),"").then(function(a){return a=a,e[116]=a[0],a})},function(a){return e[55]=e[116]}])},function(a){return e[56]=e[38].get("epoch_root_key"),d.blobs.neq(e[56],void 0)?d.sequence([function(a){return e[115]=d.createArray(),e[121]=(e[115].push(d.i64.cast([0,18])),e[115]),d.nativeOperation(b("LSCreateDerivedKeys.nop"),d.blob("bWViL2RlYnVnL2ZpbmdlcnByaW50L01FQkVwb2NoUm9vdEtleQ=="),void 0,e[56],e[115]).then(function(a){return a=a,e[116]=a[0],a})},function(a){return e[116]!==void 0?d.sequence([function(a){return e[121]=d.i64.of_int32(e[116].length),d.i64.ge(e[121],d.i64.cast([0,1]))?d.sequence([function(a){return d.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),e[116],d.i64.cast([0,0])).then(function(a){return a=a,e[123]=a[0],e[124]=a[1],a})},function(a){return e[122]=e[123]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),e[123]=d.createArray(),void 0!==void 0?e[124]=(e[123].push(void 0),e[123]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",e[123],d.i64.cast([0,3]))},function(a){return e[122]=void 0}])},function(a){return e[117]=e[122]}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBFingerprint] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),e[121]=d.createArray(),void 0!==void 0?e[122]=(e[121].push(void 0),e[121]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBFingerprint","CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",e[121],d.i64.cast([0,3]))},function(a){return e[117]=void 0}])},function(a){return d.blobs.neq(e[117],void 0)?e[118]=!0:e[118]=!1,e[118]?0:(function(a){d.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),d["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),d.nativeOperation(b("LSBase64Encode.nop"),e[117]).then(function(a){return a=a,e[119]=a[0],a})},function(a){return e[119]!==void 0?e[120]=e[119]:e[120]="encodingfailed",e[57]=e[120]}]):d.resolve(e[57]="null")},function(a){return d.nativeOperation(b("LSOcmfClientEvolve_v2.nop"),e[47]).then(function(a){return a=a,e[58]=a[0],e[59]=a[1],a})},function(a){return d.blobs.neq(void 0,void 0)?d.sequence([function(a){return d.nativeOperation(b("LSOcmfClientEvolve_v2.nop"),void 0).then(function(a){return a=a,e[115]=a[0],e[116]=a[1],a})},function(a){return a=[e[58],e[59],e[115],e[116]],e[60]=a[0],e[61]=a[1],e[62]=a[2],e[63]=a[3],a}]):d.resolve((a=[e[58],e[59],void 0,void 0],e[60]=a[0],e[61]=a[1],e[62]=a[2],e[63]=a[3],a))},function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[39]).then(function(a){return a=a,e[64]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),e[37],d.blob("dmlydHVhbF9kZXZpY2U6dmlydHVhbF9kZXZpY2VfcHJpdmF0ZV9rZXk="),e[64]==null?"":e[64]).then(function(a){return a=a,e[65]=a[0],a})},function(a){return e[65]!==void 0?e[66]=e[65]:e[66]="",e[66]===""?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_device_private_key is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","encrypted_device_private_key is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[41]).then(function(a){return a=a,e[67]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),e[37],d.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfc3RvcmFnZV9wcml2YXRlX2tleQ=="),e[67]==null?"":e[67]).then(function(a){return a=a,e[68]=a[0],a})},function(a){return e[68]!==void 0?e[69]=e[68]:e[69]="",e[69]===""?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_storage_private_key is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","encrypted_epoch_storage_private_key is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[60]).then(function(a){return a=a,e[70]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),e[37],d.blob("dmlydHVhbF9kZXZpY2U6b2NtZl9jbGllbnRfc3RhdGU="),e[70]==null?"":e[70]).then(function(a){return a=a,e[71]=a[0],a})},function(a){return e[71]!==void 0?e[72]=e[71]:e[72]="",e[72]===""?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_orf_client_state_v1_shape is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","encrypted_orf_client_state_v1_shape is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[44]).then(function(a){return a=a,e[73]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),e[37],d.blob("dmlydHVhbF9kZXZpY2U6b2JsaXZpb3VzX3ZhbGlkYXRpb25fdG9rZW4="),e[73]==null?"":e[73]).then(function(a){return a=a,e[74]=a[0],a})},function(a){return e[74]!==void 0?e[75]=e[74]:e[75]="",e[75]===""?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_oblivious_validation_token is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","encrypted_oblivious_validation_token is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[45]).then(function(a){return a=a,e[76]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),e[37],d.blob("dmlydHVhbF9kZXZpY2U6bWFpbGJveF9yb290X2tleQ=="),e[76]==null?"":e[76]).then(function(a){return a=a,e[77]=a[0],a})},function(a){return e[77]!==void 0?e[78]=e[77]:e[78]="",e[78]===""?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_mailbox_root_key is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","encrypted_mailbox_root_key is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return e[79]=e[38].get("epoch_anon_id"),d.nativeOperation(b("LSBase64Encode.nop"),e[79]).then(function(a){return a=a,e[80]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),e[37],d.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfYW5vbl9pZA=="),e[80]==null?"":e[80]).then(function(a){return a=a,e[81]=a[0],a})},function(a){return e[81]!==void 0?e[82]=e[81]:e[82]="",e[82]===""?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_anon_id is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","encrypted_epoch_anon_id is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return e[83]=e[38].get("epoch_root_key"),d.nativeOperation(b("LSBase64Encode.nop"),e[83]).then(function(a){return a=a,e[84]=a[0],a})},function(a){return d.nativeOperation(b("LSSymmetricEncryptionCreateEncryptedString.nop"),e[37],d.blob("dmlydHVhbF9kZXZpY2U6ZXBvY2hfcm9vdF9rZXk="),e[84]==null?"":e[84]).then(function(a){return a=a,e[85]=a[0],a})},function(a){return e[85]!==void 0?e[86]=e[85]:e[86]="",e[86]===""?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] encrypted_epoch_root_key is empty!"),e[115]=d.createArray(),void 0!==void 0?e[116]=(e[115].push(void 0),e[115]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","encrypted_epoch_root_key is empty!",e[115],d.i64.cast([0,3]))):d.resolve()},function(a){return e[87]=new d.Map(),e[87].set("encrypted_device_private_key",e[66]),e[87].set("encrypted_epoch_storage_private_key",e[69]),e[87].set("encrypted_ocmf_client_state",e[72]),e[87].set("encrypted_orf_client_state_v2",void 0),e[87].set("encrypted_oblivious_validation_token_blob",e[75]),e[87].set("encrypted_mailbox_root_key_blob",e[78]),e[87].set("encrypted_epoch_anon_id",e[82]),e[87].set("encrypted_epoch_root_key",e[86]),d.nativeOperation(b("LSBase64Encode.nop"),e[36]).then(function(a){return a=a,e[88]=a[0],a})},function(a){return e[109]=e[88]==null?"":e[88],d.nativeOperation(b("LSBase64Encode.nop"),e[40]).then(function(a){return a=a,e[89]=a[0],a})},function(a){return e[110]=e[89]==null?"":e[89],d.nativeOperation(b("LSBase64Encode.nop"),e[42]).then(function(a){return a=a,e[90]=a[0],a})},function(a){return e[111]=e[90]==null?"":e[90],d.nativeOperation(b("LSBase64Encode.nop"),e[43]==null?d.blob("bnVsbA=="):e[43]).then(function(a){return a=a,e[91]=a[0],a})},function(a){return e[112]=e[91]==null?"":e[91],d.nativeOperation(b("LSBase64Encode.nop"),e[55]).then(function(a){return a=a,e[92]=a[0],a})},function(a){return e[113]=e[92]==null?"":e[92],d.nativeOperation(b("LSBase64Encode.nop"),e[61]).then(function(a){return a=a,e[93]=a[0],a})},function(a){return e[114]=e[93]==null?"":e[93],d.nativeOperation(b("LSGetBlobFromString.nop"),e[30]).then(function(a){return a=a,e[94]=a[0],a})},function(a){return d.blobs.neq(e[45],void 0)?d.sequence([function(a){return e[115]=new d.Map(),d.nativeOperation(b("LSCreateDebugToken.nop"),e[45],"private_key",e[39],d.i64.cast([0,1]),e[115]).then(function(a){return a=a,e[116]=a[0],a})},function(a){return d.blobs.neq(e[116],void 0)?e[117]=e[116]:e[117]=void 0,e[95]=e[117]}]):d.resolve(e[95]=void 0)},function(a){return d.blobs.neq(e[95],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[95]).then(function(a){return a=a,e[115]=a[0],a})},function(a){return e[96]=e[115]}]):d.resolve(e[96]=void 0)},function(a){return d.blobs.neq(e[45],void 0)?d.sequence([function(a){return e[115]=new d.Map(),d.nativeOperation(b("LSCreateDebugToken.nop"),e[45],"ocmf_client_state",e[60],d.i64.cast([0,1]),e[115]).then(function(a){return a=a,e[116]=a[0],a})},function(a){return d.blobs.neq(e[116],void 0)?e[117]=e[116]:e[117]=void 0,e[97]=e[117]}]):d.resolve(e[97]=void 0)},function(a){return d.blobs.neq(e[97],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[97]).then(function(a){return a=a,e[115]=a[0],a})},function(a){return e[98]=e[115]}]):d.resolve(e[98]=void 0)},function(a){return d.blobs.neq(e[45],void 0)?d.sequence([function(a){return e[115]=new d.Map(),d.nativeOperation(b("LSCreateDebugToken.nop"),e[45],"epoch_storage_private_key",e[41],d.i64.cast([0,1]),e[115]).then(function(a){return a=a,e[116]=a[0],a})},function(a){return d.blobs.neq(e[116],void 0)?e[117]=e[116]:e[117]=void 0,e[99]=e[117]}]):d.resolve(e[99]=void 0)},function(a){return d.blobs.neq(e[99],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[99]).then(function(a){return a=a,e[115]=a[0],a})},function(a){return e[100]=e[115]}]):d.resolve(e[100]=void 0)},function(a){return d.storedProcedure(b("LSGetViewerFBID")).then(function(a){return a=a,e[101]=a[0],a})},function(a){return d.nativeOperation(b("LSGetBlobFromString.nop"),d.i64.to_string(e[101])).then(function(a){return a=a,e[102]=a[0],a})},function(a){return d.blobs.neq(e[102],void 0)?d.sequence([function(a){return e[115]=new d.Map(),d.nativeOperation(b("LSCreateDebugToken.nop"),e[102],"recovery_code",e[94],d.i64.cast([0,1]),e[115]).then(function(a){return a=a,e[116]=a[0],a})},function(a){return d.blobs.neq(e[116],void 0)?e[117]=e[116]:e[117]=void 0,e[103]=e[117]}]):d.resolve(e[103]=void 0)},function(a){return d.blobs.neq(e[103],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSBase64Encode.nop"),e[103]).then(function(a){return a=a,e[115]=a[0],a})},function(a){return e[104]=e[115]}]):d.resolve(e[104]=void 0)},function(c){return d.i64.neq(e[46],void 0)?d.sequence([function(a){return e[115]=e[38].get("epoch_id"),d.db.table(168).fetch().next().then(function(b,c){var a=b.done;b=b.value;return a?e[116]=d.i64.cast([0,1]):(c=b.item,e[121]=c.backupTenancy,d.i64.neq(e[121],void 0)?e[120]=e[121]:e[120]=d.i64.cast([0,1]),e[116]=e[120])})},function(a){return d.i64.eq(e[116],d.i64.cast([0,2]))?d.resolve(e[118]=void 0):d.sequence([function(a){return d.nativeOperation(b("LSGetArmadilloPublicKey.nop")).then(function(a){return a=a,e[120]=a[0],a})},function(a){return e[118]=e[120]}])},function(a){return d.blobs.neq(e[118],void 0)?d.sequence([function(a){return d.nativeOperation(b("LSCreateSignatureWithArmadilloKey.nop"),e[40]).then(function(a){return a=a,e[120]=a[0],a})},function(a){return d.blobs.neq(e[120],void 0)?d.resolve(e[121]=e[120]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoKeySigningUtils] Failed to create labyrinth signature"),e[125]=d.createArray(),void 0!==void 0?e[126]=(e[125].push(void 0),e[125]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoKeySigningUtils","Failed to create labyrinth signature",e[125],d.i64.cast([0,3]))},function(a){return e[121]=void 0}])},function(a){return d.nativeOperation(b("LSCreateSignature_v2.nop"),e[39],d.blob("Mw=="),e[118]).then(function(a){return a=a,e[122]=a[0],a})},function(a){return d.blobs.neq(e[122],void 0)?d.resolve(e[123]=e[122]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoKeySigningUtils] Failed to create armadillo signature"),e[125]=d.createArray(),void 0!==void 0?e[126]=(e[125].push(void 0),e[125]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoKeySigningUtils","Failed to create armadillo signature",e[125],d.i64.cast([0,3]))},function(a){return e[123]=void 0}])},function(a){return d.blobs.neq(e[123],void 0)?(d.blobs.neq(e[121],void 0)?(e[126]=new d.Map(),e[126].set("armadillo_public_key",e[118]),e[126].set("armadillo_key_signature",e[123]),e[126].set("labyrinth_key_signature",e[121]),e[125]=e[126]):e[125]=void 0,e[124]=e[125]):e[124]=void 0,e[119]=e[124]}]):d.resolve(e[119]=void 0)},function(c){return e[119]!==void 0?d.sequence([function(a){return e[120]=e[119].get("armadillo_public_key"),d.nativeOperation(b("LSBase64Encode.nop"),e[120]).then(function(a){return a=a,e[121]=a[0],a})},function(a){return e[122]=e[119].get("armadillo_key_signature"),d.nativeOperation(b("LSBase64Encode.nop"),e[122]).then(function(a){return a=a,e[123]=a[0],a})},function(a){return e[124]=e[119].get("labyrinth_key_signature"),d.nativeOperation(b("LSBase64Encode.nop"),e[124]).then(function(a){return a=a,e[125]=a[0],a})},function(c){return e[126]=new d.Map(),e[126].set("backup_id",e[1]),e[126].set("request_device_id",e[46]),e[126].set("virtual_device_id",e[109]),e[126].set("encrypted_secret_values",e[87]),e[126].set("public_key",e[110]),e[126].set("epoch_storage_pubkey",e[111]),e[126].set("epoch_storage_pubkey_sig",e[112]),e[126].set("device_epoch_hmac",e[113]),e[126].set("epoch_root_key_fingerprint",e[57]),e[126].set("ocmf_rotation_token",e[114]),e[126].set("is_init",!1),e[126].set("epoch_id",e[115]),e[126].set("virtual_device_type",e[31]),e[126].set("action_type",a[0]),e[126].set("private_key_debug_token",e[96]),e[126].set("ocmf_client_state_debug_token",e[98]),e[126].set("epoch_storage_pvtkey_debug_token",e[100]),e[126].set("recovery_code_debug_token",e[104]),e[126].set("trace_id",void 0),e[126].set("cloud_service_account",e[32]),e[126].set("hsm_pin_normalization_status",e[33]),e[126].set("security_question_type",void 0),e[126].set("trusted_contact_id",void 0),e[126].set("armadillo_public_key",e[121]==null?"":e[121]),e[126].set("armadillo_key_signature",e[123]==null?"":e[123]),e[126].set("labyrinth_key_signature",e[125]==null?"":e[125]),e[127]=d.toJSON(e[126]),d.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",d.i64.cast([0,50004]),e[127],d.i64.cast([0,0]),d.i64.cast([0,93]),d.i64.cast([0,0]),void 0,d.i64.cast([0,0])).then(function(a){return a=a,e[128]=a[0],a})}]):(function(a){d.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] failed to get armadillo key and device signatures"),e[120]=new d.Map(),e[120].set("backup_id",e[1]),e[120].set("request_device_id",e[46]),e[120].set("virtual_device_id",e[109]),e[120].set("encrypted_secret_values",e[87]),e[120].set("public_key",e[110]),e[120].set("epoch_storage_pubkey",e[111]),e[120].set("epoch_storage_pubkey_sig",e[112]),e[120].set("device_epoch_hmac",e[113]),e[120].set("epoch_root_key_fingerprint",e[57]),e[120].set("ocmf_rotation_token",e[114]),e[120].set("is_init",!1),e[120].set("epoch_id",e[115]),e[120].set("virtual_device_type",e[31]),e[120].set("action_type",a[0]),e[120].set("private_key_debug_token",e[96]),e[120].set("ocmf_client_state_debug_token",e[98]),e[120].set("epoch_storage_pvtkey_debug_token",e[100]),e[120].set("recovery_code_debug_token",e[104]),e[120].set("trace_id",void 0),e[120].set("cloud_service_account",e[32]),e[120].set("hsm_pin_normalization_status",e[33]),e[120].set("security_question_type",void 0),e[120].set("trusted_contact_id",void 0),e[121]=d.toJSON(e[120]),d.storedProcedure(b("LSIssueNewEbTaskAndGetTaskIDV2"),"encrypted_backups_setup",d.i64.cast([0,50004]),e[121],d.i64.cast([0,0]),d.i64.cast([0,93]),d.i64.cast([0,0]),void 0,d.i64.cast([0,0])).then(function(a){return a=a,e[122]=a[0],a}))}]):d.storedProcedure(b("LSHandleCreateVirtualDeviceFailure"),e[1],!1,void 0)}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Epoch keys are unavailable."),e[39]=d.createArray(),void 0!==void 0?e[40]=(e[39].push(void 0),e[39]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","Epoch keys are unavailable.",e[39],d.i64.cast([0,3]))},function(a){return d.storedProcedure(b("LSHandleCreateVirtualDeviceFailure"),e[1],!1,void 0)}])}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Provided"),e[38]=d.createArray(),void 0!==void 0?e[39]=(e[38].push(void 0),e[38]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","Invalid Recovery Code Provided",e[38],d.i64.cast([0,3]))},function(a){return d.storedProcedure(b("LSHandleCreateVirtualDeviceFailure"),e[1],!1,void 0)}]):d.sequence([function(a){return function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure] Invalid Recovery Code Provided"),e[38]=d.createArray(),void 0!==void 0?e[39]=(e[38].push(void 0),e[38]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateVirtualDeviceV2StoredProcedure","Invalid Recovery Code Provided",e[38],d.i64.cast([0,3]))},function(a){return d.storedProcedure(b("LSHandleCreateVirtualDeviceFailure"),e[1],!1,void 0)}])}])},function(a){return e[26]=d.i64.cast([0,0])}]))})},function(a){return e[19]=e[26]}]):d.sequence([function(a){return d.db.table(178).put({pk:d.i64.cast([0,1]),recoveryCodeStatus:d.i64.cast([0,3])})},function(a){return e[26]="Backup is not initalized",e[26]!==void 0?d.sequence([function(a){return e[28]=["[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] ","",e[26]].join(""),function(a){d.logger(a).mustfix(a)}(e[28]),e[27]=d.createArray(),void 0!==void 0?e[29]=(e[27].push(void 0),e[27]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure",e[26],e[27],d.i64.cast([0,3]))},function(a){return d.sequence([function(a){return void 0!==void 0?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,85]),d.i64.cast([0,2]),e[28],void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[31]=a[0],a})},function(a){return e[31]?e[32]=!0:e[32]=!1,e[32]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[33]=d.createArray(),void 0!==void 0?e[34]=(e[33].push(void 0),e[33]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[33],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return void 0!==void 0?d.nativeOperation(b("LSFlushDataTrace.nop"),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[29]=a[0],a})},function(a){return e[29]?e[30]=!0:e[30]=!1,e[30]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[31]=d.createArray(),void 0!==void 0?e[32]=(e[31].push(void 0),e[31]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[31],d.i64.cast([0,3]))):d.resolve()}])}]):d.sequence([function(a){return void 0!==void 0?d.sequence([function(a){return void 0!==void 0?d.storedProcedure(b("LSAppendDataTraceAddon"),void 0,d.i64.cast([0,85]),d.i64.cast([0,2]),["[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] ","",""].join(""),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[29]=a[0],a})},function(a){return e[29]?e[30]=!0:e[30]=!1,e[30]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[31]=d.createArray(),void 0!==void 0?e[32]=(e[31].push(void 0),e[31]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[31],d.i64.cast([0,3]))):d.resolve()}]):d.resolve()},function(a){return void 0!==void 0?d.nativeOperation(b("LSFlushDataTrace.nop"),void 0):d.resolve()},function(a){return d.storedProcedure(b("LSIsMobileClient")).then(function(a){return a=a,e[27]=a[0],a})},function(a){return e[27]?e[28]=!0:e[28]=!1,e[28]&&!0?(function(a){d.logger(a).mustfix(a)}("[EncryptedBackups][MEBTraceUtils] LSDataTraceMciTraceLog native op not supported"),e[29]=d.createArray(),void 0!==void 0?e[30]=(e[29].push(void 0),e[29]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBTraceUtils","LSDataTraceMciTraceLog native op not supported",e[29],d.i64.cast([0,3]))):d.resolve()}])},function(a){return d.forEach(d.db.table(174).fetch(),function(a){return a["delete"]()})},function(a){return e[19]=d.i64.cast([0,1])}])},function(a){return e[20]=d.i64.of_float(Date.now()),e[21]=d.i64.random(),e[23]="Finishing execution. Execution time: ",e[24]=d.i64.to_string(d.i64.sub(e[20],e[0])),e[25]=" ms",e[22]="",function(a){d.logger(a).info(a)}(["[EncryptedBackups][LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure] ",e[22],e[23],e[22],e[24],e[22],e[25]].join("")),d.i64.eq(d.i64.mod_(e[21],d.i64.cast([0,1e3])),d.i64.cast([0,0]))?(e[26]=",",e[27]=d.createArray(),void 0!==void 0?e[28]=(e[27].push(void 0),e[27]):0,d.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure",[e[23],e[26],e[24],e[26],e[25]].join(""),e[27],d.i64.cast([0,4]))):d.resolve()},function(a){return f[0]=e[19]}])},function(a){return d.resolve(f)}])}a.__sproc_name__="LSEncryptedBackupsCreateExtraVirtualDeviceStoredProcedure";a.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_generated_recovery_code","secure_encrypted_backups_recovery_code_status","secure_encrypted_backups_epochs"];d=a;g["default"]=d}),98);
__d("LSCreateExtraVirtualDeviceStoredProcedure",["LSCreateExtraVirtualDevice","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSCreateExtraVirtualDevice"),e.actionType,e.traceId);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MWEncryptedBackupsCreateExtraVirtualDevice",["LSCreateExtraVirtualDeviceStoredProcedure","LSFactory"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return a.runInTransaction(function(a){return c("LSCreateExtraVirtualDeviceStoredProcedure")(c("LSFactory")(a),{actionType:b})},"readwrite",void 0,void 0,f.id+":24")}g.initializeCreateExtraVirtualDeviceStoredProcedure=a}),98);
__d("VestaDeleteAccountMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="7815525315199853"}),null);
__d("VestaDeleteAccountMutation.graphql",["VestaDeleteAccountMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{kind:"Variable",name:"delete_account_request",variableName:"input"}],d={alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaDeleteAccountMutation",selections:[{alias:null,args:c,concreteType:"VestaDeleteAccountResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_delete_account",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"hsm_virtual_device",plural:!1,selections:[d],storageKey:null},{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaDeleteAccountMutation",selections:[{alias:null,args:c,concreteType:"VestaDeleteAccountResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_delete_account",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"hsm_virtual_device",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("VestaDeleteAccountMutation_facebookRelayOperation"),metadata:{},name:"VestaDeleteAccountMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("VestaDeleteAccount",["CometRelay","VestaDeleteAccountMutation.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var c=a.clientId,e=a.environment,f=a.optimisticUpdater,g=a.productUseCase;a=a.updater;var i=h!==void 0?h:h=b("VestaDeleteAccountMutation.graphql");return d("CometRelay").commitMutation(e,{mutation:i,optimisticUpdater:f,updater:a,variables:{input:{fbid:c,product_use_case:g,vesta_client_api_version:6}}})}g.vestaDeleteAccount=a}),98);
__d("VestaServerGraphQLRegisterProviderBeginRegisterMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="4596530973809082"}),null);
__d("VestaServerGraphQLRegisterProviderBeginRegisterMutation.graphql",["VestaServerGraphQLRegisterProviderBeginRegisterMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{alias:null,args:[{kind:"Variable",name:"begin_register_request",variableName:"input"}],concreteType:"VestaBeginRegisterResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_begin_register",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_r2",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_challenge",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_r2_sig",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLRegisterProviderBeginRegisterMutation",selections:c,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLRegisterProviderBeginRegisterMutation",selections:c},params:{id:b("VestaServerGraphQLRegisterProviderBeginRegisterMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLRegisterProviderBeginRegisterMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLRegisterProviderFinishRegisterMutation_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="6632076876855152"}),null);
__d("VestaServerGraphQLRegisterProviderFinishRegisterMutation.graphql",["VestaServerGraphQLRegisterProviderFinishRegisterMutation_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],c=[{kind:"Variable",name:"finish_register_request",variableName:"input"}],d={alias:null,args:null,kind:"ScalarField",name:"register_success",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"client_generated_id",storageKey:null};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLRegisterProviderFinishRegisterMutation",selections:[{alias:null,args:c,concreteType:"VestaFinishRegisterResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_finish_register",plural:!1,selections:[d,{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"hsm_virtual_device",plural:!1,selections:[e],storageKey:null},{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useMWChatEncryptedBackupsVestaUserInfo_vestaGetUserInfoResponse"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLRegisterProviderFinishRegisterMutation",selections:[{alias:null,args:c,concreteType:"VestaFinishRegisterResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_finish_register",plural:!1,selections:[d,{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"MessengerDefaultEncryptedBackup",kind:"LinkedField",name:"messenger_default_encrypted_backup",plural:!1,selections:[{alias:null,args:null,concreteType:"XFBEBVirtualDevice",kind:"LinkedField",name:"hsm_virtual_device",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VestaGetUserInfoResponse",kind:"LinkedField",name:"vesta_user_info",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"login_timeout_remaining_secs",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{id:b("VestaServerGraphQLRegisterProviderFinishRegisterMutation_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLRegisterProviderFinishRegisterMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLRegisterProviderInitQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5066599476720964"}),null);
__d("VestaServerGraphQLRegisterProviderInitQuery.graphql",["VestaServerGraphQLRegisterProviderInitQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"request"}],c=[{alias:null,args:[{kind:"Variable",name:"vesta_init_request",variableName:"request"}],concreteType:"VestaInitIqResponse",kind:"LinkedField",name:"fbid_based_auth_layer_vesta_register_init",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_rsa_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_opaque_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"base64url_encoded_island_ed25519_pub_signature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_registered",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attempts_remaining",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"VestaServerGraphQLRegisterProviderInitQuery",selections:c,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"VestaServerGraphQLRegisterProviderInitQuery",selections:c},params:{id:b("VestaServerGraphQLRegisterProviderInitQuery_facebookRelayOperation"),metadata:{},name:"VestaServerGraphQLRegisterProviderInitQuery",operationKind:"query",text:null}}}();e.exports=a}),null);
__d("VestaServerGraphQLRegisterProvider",["E2EEBackupUtil","Promise","RelayHooks","RelayModern","VestaServerGraphQLRegisterProviderBeginRegisterMutation.graphql","VestaServerGraphQLRegisterProviderFinishRegisterMutation.graphql","VestaServerGraphQLRegisterProviderInitQuery.graphql","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function a(a,b){return l.apply(this,arguments)}function l(){l=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){c=c.environment;c=(yield d("RelayHooks").fetchQuery(c,h!==void 0?h:h=b("VestaServerGraphQLRegisterProviderInitQuery.graphql"),{request:{fbid:a.clientId,product_use_case:a.productUseCase,vesta_client_api_version:6}}).toPromise());a=c==null?void 0:c.fbid_based_auth_layer_vesta_register_init;c=a==null?void 0:a.base64url_encoded_island_rsa_pub;var e=a==null?void 0:a.base64url_encoded_island_rsa_pub_signature,f=a==null?void 0:a.base64url_encoded_opaque_pub,g=a==null?void 0:a.base64url_encoded_opaque_pub_signature,i=a==null?void 0:a.base64url_encoded_island_ed25519_pub,j=a==null?void 0:a.base64url_encoded_island_ed25519_pub_signature,k=a==null?void 0:a.is_registered;a=a==null?void 0:a.attempts_remaining;if(c!=null&&e!=null&&f!=null&&g!=null&&i!=null&&j!=null&&k!=null){var l;return{islandRsaPub:(l=d("E2EEBackupUtil")).decodeBase64Url(c),islandRsaPubSig:l.decodeBase64Url(e),opaquePub:l.decodeBase64Url(f),opaquePubSig:l.decodeBase64Url(g),islandEd25519Pub:l.decodeBase64Url(i),islandEd25519PubSig:l.decodeBase64Url(j),isRegistered:k,loginAttemptsRemaining:a}}throw new Error("GraphQL Response is Null")});return l.apply(this,arguments)}function c(a,c){var e=c.environment,f=i!==void 0?i:i=b("VestaServerGraphQLRegisterProviderBeginRegisterMutation.graphql"),g={input:{base64url_encoded_opaque_r1:d("E2EEBackupUtil").encodeBase64Url(a.opaqueR1),fbid:a.clientId,product_use_case:a.productUseCase,vesta_client_api_version:6}};return new(k||(k=b("Promise")))(function(a,b){d("RelayModern").commitMutation(e,{mutation:f,variables:g,onCompleted:function(c){c=c.fbid_based_auth_layer_vesta_begin_register;var e=c==null?void 0:c.base64url_encoded_opaque_r2,f=c==null?void 0:c.base64url_encoded_opaque_challenge;c=c==null?void 0:c.base64url_encoded_opaque_r2_sig;if(e!=null&&f!=null&&c!=null){a({opaqueR2:d("E2EEBackupUtil").decodeBase64Url(e),opaqueChallenge:d("E2EEBackupUtil").decodeBase64Url(f),opaqueR2Sig:d("E2EEBackupUtil").decodeBase64Url(c)});return}b(new Error("GraphQL Response is Null"))},onError:function(a){b(a)}})})}function e(a,c){var e=c.environment,f=c.updater;return new(k||(k=b("Promise")))(function(c,g){d("RelayModern").commitMutation(e,{mutation:j!==void 0?j:j=b("VestaServerGraphQLRegisterProviderFinishRegisterMutation.graphql"),variables:{input:{base64url_encoded_enc_reg_payload:d("E2EEBackupUtil").encodeBase64Url(a.encRegPayload),fbid:a.clientId,product_use_case:a.productUseCase,vesta_client_api_version:6}},onCompleted:function(a){a=(a=a.fbid_based_auth_layer_vesta_finish_register)==null?void 0:a.register_success;if(a!=null){c({registerSuccess:a});return}g(new Error("GraphQL Response is Null"))},onError:function(a){g(a)},updater:f})})}g.initRegister=a;g.beginRegister=c;g.finishRegister=e}),98);